@model Auto_Insurance_Management_System.ViewModels.PolicyDetailsViewModel
@{
    ViewData["Title"] = "Policy Details";
    var isAdminOrAgent = User.IsInRole("ADMIN") || User.IsInRole("AGENT");
}

<div class="container mt-4">
    <h2 class="mb-3">Policy Details</h2>

    <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
            <strong>Policy #: @Model.PolicyNumber</strong>
        </div>
        <div class="card-body">
            <dl class="row mb-0">
                <dt class="col-sm-4">Customer Name</dt>
                <dd class="col-sm-8">@Model.UserName</dd>

                <dt class="col-sm-4">Vehicle Make</dt>
                <dd class="col-sm-8">@Model.VehicleMake</dd>

                <dt class="col-sm-4">Vehicle Model</dt>
                <dd class="col-sm-8">@Model.VehicleModel</dd>

                <dt class="col-sm-4">Vehicle Year</dt>
                <dd class="col-sm-8">@Model.VehicleYear</dd>

                <dt class="col-sm-4">License Plate</dt>
                <dd class="col-sm-8">@Model.LicensePlate</dd>

                <dt class="col-sm-4">Coverage Type</dt>
                <dd class="col-sm-8">@Model.CoverageType</dd>

                <dt class="col-sm-4">Coverage Amount</dt>
                <dd class="col-sm-8">₹@Model.CoverageAmount.ToString("N2")</dd>

                <dt class="col-sm-4">Premium Amount</dt>
                <dd class="col-sm-8">₹@Model.PremiumAmount.ToString("N2")</dd>

                <dt class="col-sm-4">Policy Start Date</dt>
                <dd class="col-sm-8">@Model.StartDate.ToString("dd MMM yyyy")</dd>

                <dt class="col-sm-4">Policy End Date</dt>
                <dd class="col-sm-8">@Model.EndDate.ToString("dd MMM yyyy")</dd>

                <dt class="col-sm-4">Policy Status</dt>
                <dd class="col-sm-8">
                    <span class="badge bg-@GetBadgeColor(Model.PolicyStatus)">
                        @Model.PolicyStatus
                    </span>
                </dd>

                <dt class="col-sm-4">Created On</dt>
                <dd class="col-sm-8">@Model.DateCreated.ToString("dd MMM yyyy, hh:mm tt")</dd>
            </dl>
        </div>
        <div class="card-footer text-end">
          @if (isAdminOrAgent){
            <a asp-action="Edit" asp-route-id="@Model.PolicyId" class="btn btn-outline-primary me-2">Edit</a>
          }
            <a asp-action="Index" class="btn btn-secondary">Back to List</a>
        </div>
    </div>
</div>

@functions {
    public string GetBadgeColor(string status)
    {
        return status switch
        {
            "Active" => "success",
            "Pending" => "warning",
            "Expired" => "danger",
            _ => "secondary"
        };
    }
}
